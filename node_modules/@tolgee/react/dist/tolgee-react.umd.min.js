!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("@tolgee/web")):"function"==typeof define&&define.amd?define(["exports","react","@tolgee/web"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["@tolgee/react"]={},e.React,e["@tolgee/web"])}(this,(function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var s=r(t);function o(e,r,s,o=!0){const[a]=t.useState((()=>{return t=e,Object.assign(Object.assign({},t),{t(...e){const r=n.getTranslateProps(...e);return t.t(Object.assign(Object.assign({},r),{noWrap:!0}))}});var t})),[l,u]=t.useState(o);return t.useEffect((()=>{u(!1)}),[]),t.useMemo((()=>{o&&(e.setEmitterActive(!1),e.addStaticData(s),e.changeLanguage(r),e.setEmitterActive(!0))}),[r,s,e]),t.useState((()=>{if(!e.isLoaded()&&o){const t=e.getRequiredRecords(r).map((({namespace:e,language:t})=>e?`${e}:${t}`:t)).filter((e=>!(null==s?void 0:s[e])));console.warn(`Tolgee: Missing records in "staticData" for proper SSR functionality: ${t.map((e=>`"${e}"`)).join(", ")}`)}})),l?a:e}const a={useSuspense:!0};let l;const u=()=>(l||(l=s.default.createContext(void 0)),l);let c;let i;const d=()=>{const e=u(),n=t.useContext(e)||i;if(!n)throw new Error("Couldn't find tolgee instance, did you forgot to use `TolgeeProvider`?");return n},f=()=>{const[e,n]=t.useState(0);return{instance:e,rerender:t.useCallback((()=>{n((e=>e+1))}),[n])}},g=(e,r)=>{const{tolgee:s,options:o}=d(),a=n.getFallback(e),l=n.getFallbackArray(a).join(":"),u=Object.assign(Object.assign({},o),r),{rerender:c,instance:i}=f(),g=t.useRef(),b=t.useRef([]);b.current=[];const p=s.isLoaded(a);t.useEffect((()=>{const e=s.onNsUpdate(c);return g.current=e,e.subscribeNs(a),b.current.forEach((t=>{e.subscribeNs(t)})),()=>{e.unsubscribe()}}),[l,s]),t.useEffect((()=>(s.addActiveNs(a),()=>s.removeActiveNs(a))),[l,s]);const v=t.useCallback((e=>{var t;const n=null!==(t=e.ns)&&void 0!==t?t:null==a?void 0:a[0];return(e=>{var t;b.current.push(e),null===(t=g.current)||void 0===t||t.subscribeNs(e)})(n),s.t(Object.assign(Object.assign({},e),{ns:n}))}),[s,i]);if(u.useSuspense&&!p)throw s.addActiveNs(a,!0);return{t:v,isLoading:!p}};const b=e=>{if(!e)return;const t={};return Object.entries(e||{}).forEach((([e,n])=>{if("function"==typeof n)t[e]=e=>n(p(e));else if(s.default.isValidElement(n)){const r=n;t[e]=e=>void 0===r.props.children&&(null==e?void 0:e.length)?s.default.cloneElement(r,{},p(e)):s.default.cloneElement(r)}else t[e]=n})),t},p=e=>{const t=(n=e,Array.isArray(n)&&1===n.length?n[0]:n);var n;return Array.isArray(t)?t.map(((e,t)=>s.default.createElement(s.default.Fragment,{key:t},e))):t},v=e=>{const t=e.keyName||e.children;void 0===t&&console.error("T component: keyName not defined");const n=e.defaultValue||(e.keyName?e.children:void 0),r=p(e.t({key:t,params:b(e.params),defaultValue:n,noWrap:e.noWrap,ns:e.ns,language:e.language}));return s.default.createElement(s.default.Fragment,null,r)};e.GlobalContextPlugin=e=>t=>(i={tolgee:t,options:Object.assign(Object.assign({},a),e)},t),e.T=e=>{const{t:t}=g();return s.default.createElement(v,Object.assign({t:t},e))},e.TBase=v,e.TolgeeProvider=({tolgee:e,options:n,children:r,fallback:l,ssr:i})=>{t.useEffect((()=>{(null==c?void 0:c.run)!==e.run&&(c&&c.stop(),c=e,e.run().catch((e=>{console.error(e)})).finally((()=>{p(!1)})))}),[e]);let d=e;const{language:f,staticData:g}="object"!=typeof i?{}:i;d=o(e,f,g,Boolean(i));const[b,p]=t.useState(!d.isLoaded()),v=Object.assign(Object.assign({},a),n),m=u();return v.useSuspense?s.default.createElement(m.Provider,{value:{tolgee:d,options:v}},b?l:s.default.createElement(t.Suspense,{fallback:l||null},r)):s.default.createElement(m.Provider,{value:{tolgee:d,options:v}},b?l:r)},e.getProviderInstance=u,e.useTolgee=e=>{const{tolgee:n}=d(),{rerender:r}=f();return t.useEffect((()=>{const t=null==e?void 0:e.map((e=>n.on(e,r)));return()=>{null==t||t.forEach((e=>e.unsubscribe()))}}),[null==e?void 0:e.join(":")]),n},e.useTolgeeSSR=o,e.useTranslate=(e,r)=>{const{t:s,isLoading:o}=g(e,r);return{t:t.useCallback(((...e)=>{const t=n.getTranslateProps(...e);return s(t)}),[s]),isLoading:o}},Object.keys(n).forEach((function(t){"default"===t||e.hasOwnProperty(t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}})})),Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=tolgee-react.umd.min.js.map
